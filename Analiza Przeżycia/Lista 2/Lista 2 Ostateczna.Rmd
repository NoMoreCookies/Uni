---
title: "Lista 2"
header-includes:
  - \usepackage{float}
output:
  pdf_document: default
  html_document: default
date: "2025-10-26"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```

```{r libraries_import}
library(ggplot2)
library(dplyr)
library(tidyr)
library(xtable)
library(survival)
library(survminer)
library(survRM2)
set.seed(123)
```

# Zadanie 1

Funckja została napisana zgodnie z wytycznymi zadania
```{r zad1}

#--------------------------Generatory-------------------------------
gen1 <- function(n, alpha, lambda, t0){
  y <- runif(n)
  x <- - (1/lambda)*log(1- y^(1/alpha))
  
  delta <- ifelse(x <= t0, 1, 0)
  x_obs <- pmin(x, t0)
  
  return(data.frame(x = x_obs, delta = delta))
}

gen2 <- function(n, alpha, lambda, m) {
  y <- runif(n)
  x <- - (1/lambda)*log(1- y^(1/alpha))
  
  x <- sort(x)
  x_cenz <- x[m]
  
  x <- c(x[1:m], rep(x_cenz, n-m))
  delta <- c(rep(1,m), rep(0, n-m))
  
  return(data.frame(x, delta))
}


gen3 <-  function(n, alpha, lambda, eta){
  y <- runif(n)
  x <- - (1/lambda)*log(1- y^(1/alpha))
  c <- rexp(n, rate=1/eta)
  x <- pmin(x, c)
  delta <- ifelse(x==c, 0, 1)
  
  return(data.frame(x, delta))
}
#-------------------------------------------------------------------------
```


# Zadanie 2


```{r zad2,results='asis'}

wygeneruj_zm_opisowe <- function(values){
 
  
  censored <- values$delta
  values <- 1 - values$x
  
  results <- data.frame(
  Q1 = quantile(values,1/4),
  Q2 = quantile(values,1/2),
  Q3 = quantile(values,3/4),
  RANGE = diff(range(values)),
  IQR = quantile(values,3/4)-quantile(values,1/4),
  CENSORED = sum(censored),
  NCENSORED = length(censored)-sum(censored))
  return (results)
}

df1 <- wygeneruj_zm_opisowe(gen1(n=20, alpha = 1.2, lambda = 1, t0=7))
df2 <- wygeneruj_zm_opisowe(gen2(n=20, alpha = 1.2, lambda = 1,m=12))
df3 <- wygeneruj_zm_opisowe(gen3(n=20, alpha = 1.2, lambda = 1, eta = 1.8))

df_all <- rbind(df1,df2,df3)
rownames(df_all) <- c("Cenzura 1 typu","Cenzura 2 typu","Cenzura 3 typu")
tab <- xtable(df_all,digits = 4, caption = "Statystyki opisowe dla wygenerowanych danych cenzurowanych") 
print(tab,type = "latex",comment = FALSE,table.placement = "H",caption.placement = "top")
```

Wnioski : 

# Zadanie 3


```{r zad3,results='asis'}

times_A <- c(0.03345514, 0.08656403, 0.08799947, 0.24385821, 0.27755032,
             0.40787247, 0.58825664, 0.64125620, 0.90679161, 0.94222208)

times_B <- c(0.03788958, 0.12207257, 0.20319983, 0.24474299, 0.30492413,
             0.34224462, 0.42950144, 0.44484582, 0.63805066, 0.69119721)

wygeneruj_zm_opisowe <- function(values){
 
  
  
  results <- data.frame(
  Q1 = quantile(values,1/4),
  Q2 = quantile(values,1/2),
  Q3 = quantile(values,3/4),
  RANGE = diff(range(values)),
  IQR = quantile(values,3/4)-quantile(values,1/4))
  return (results)
}

df1 <- wygeneruj_zm_opisowe(times_A)
df2 <- wygeneruj_zm_opisowe(times_B)

df_all <- rbind(df1,df2)
rownames(df_all) <- c("lek A","lek B")

tab <- xtable(df_all,digits = 4,caption = "Statystyki opisowe dla danych dotyczcych leków ") 
print(tab,type = "latex",comment = FALSE,table.placement = "H",caption.placement = "top")

```
Wnioski : 