
#-----------------*************** Lista 3 MRF ***************-------------------

#_______________________________________________________________________________
#
#------------------------------Zadanie 3.1--------------------------------------
#
#_______________________________________________________________________________
# Ile wyniosła cena "brudna" obligacji PS0123 kupionej na GPW w dniu 
# D=12.02.2019 po kursie 102.40? 
# Przyjmujemy tutaj, że dzień rozliczenia transakcji to D+2.
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

```{r zad 1}
 
kurs = 1.024

oprocentowanie = 0.025

w_nominalna = 1000

c_czysta = w_nominalna * kurs

c_brudna = c_czysta+(oprocentowanie * w_nominalna*2/365)

c_brudna


```



#_______________________________________________________________________________
#
#------------------------------Zadanie 3.2--------------------------------------
#
#_______________________________________________________________________________
# Jedna sztuka obligacji OK0521 została kupiona na Giełdzie Papierów 
# Wartościowych (GPW) w dniu D=20.02.2019 po kursie 96,90. 
# Jaka jest rentowność tej inwestycji dla  kupującego 
# (zakładając, że będzie trzymał obligację do dnia wykupu), 
# jeśli prowizja maklerska jaką płaci kupujący wynosi 0,12% 
# wartości transakcji? Przyjmujemy tutaj, że dzień rozliczenia transakcji 
# to D+2.
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

```{r zad 2}

kurs = 0.969

w_nominalna = 1000

zysk_netto = w_nominalna

koszt = w_nominalna * kurs * (1 + 0.0012)

YTM = ((zysk_netto/koszt))^(365/834)

YTM

```

odp : 1.33%
#_______________________________________________________________________________
#
#------------------------------Zadanie 3.3--------------------------------------
#
#_______________________________________________________________________________
# Dana jest obligacja zerokuponowa, w przypadku której do terminu wykupu 
# pozostały dwa lata i 115 dni. Jej wartość nominalna wynosi 100 PLN,
# a wymagana stopa dochodu inwestora 10%. Dokonaj wyceny obligacji. 
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

```{r zad 3}
t = 2 * 365 + 115

w_nominalna = 100
stopa_dochodu = 0.10

#1.1 = (w_nominalna/cena_obl)^(365/t)

#więc

cena_obl = (1.1)^(-t/365)*w_nominalna

cena_obl


```

odp 80.19977 Zł
#_______________________________________________________________________________
#
#------------------------------Zadanie 3.4--------------------------------------
#
#_______________________________________________________________________________
# Pewien inwestor zakupił obligację zerokuponową w przypadku której do
# terminu wykupu pozostało 10 lat. Rynkowa stopa rentowności przy zakupie
# wynosiła 7,25%. Inwestor ten, po 25 miesiącach sprzedał obligację,
# przy stopie rentowności 6,75%. Jaką stopę zwrotu uzyskał inwestor 
# na tej obligacji?
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

```{r zad 4}



# P(1+0.0725)^(10) = F
#NP(1+0.0675)^(10-25/12) = F
# P(1+0.0725)^(10) = NP(1+0.0675)^(10-25/12)
#NP = P(1+0.0725)^(10)/(1+0.0675)^(10-25/12)
#(NP-P)/P TO NASZA STOPA ZWROTU

((1+0.0725)^10/(1+0.0675)^(10-25/12)-1)*100
```
odp 20.058%

#_______________________________________________________________________________
#
#------------------------------Zadanie 3.5--------------------------------------
#
#_______________________________________________________________________________
# Inwestor rozważa zakup obligacji zerokuponowych o terminie do wykupu jeden,
# trzy lub pięć lat. W tym momencie rentowności obligacji zerokuponowych 
# 
# 1-, 2-, 3-, 4-, 5-letnich
# 
# to odpowiednio 
#
# 3,1%, 3,8%, 4%, 4,2%  4,3%
#
# przy czym rentowność jest wyrażona w skali roku z kapitalizacją co pół roku.
#
# Inwestor planuje sprzedaż kupowanych dziś obligacji za rok. 
# Rozważa przy tym dwa następujące scenariusze:
# 
# I. Stopy procentowe za rok będą takie same jak dziś i dlatego rentowności 
# obligacji 1-, 2-, 3-, 4- i 5-letnich wyniosą odpowiednio 
# 
# 3,1%, 3,8%, 4%, 4,2%  4,3%
#
# II. Stopy procentowe (dla wszystkich okresów) za rok będą o $0,5$ p.p. 
# (punktu procentowego) wyższe niż dziś tzn. 
# rentowność obligacji 1-rocznych wyniesie 3,6%,
# dwuletnich 4,3% itd, przy czym rentowność jest tu również wyrażona 
# w skali roku z kapitalizacją co pół roku.
#
# Które z obligacji powinien zakupić inwestor w każdym z tych dwóch scenariuszy,
# aby uzyskać jak najwyższą stopę zwrotu z tej rocznej inwestycji?
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
```{r pom_funkc}

hajs_z_obligacji <- function(t_wkp,rent_p,kpt,rent_f,t_sprz){
  
  #P1 = F/(1+rent_p/kpt)^(kpt*t_wkp)
  #P2 = F/(1+rent_f/kpt)^(kpt*(t_wkp-t_sprz))
  #P2/P1
  return (( (1+rent_p/kpt)^(kpt*t_wkp)/(1+rent_f/kpt)^(kpt*(t_wkp-t_sprz))-1)*100 ) 
}


```
# I scenariusz:

```{r I}
t_wkp = c(1,2,3,4,5)
rent_p = c(3.1, 3.8, 4, 4.2,4.3)/100
kpt = 2
rent_f = rent_p
t_sprz = 1
for( i in 1:5){
  print(hajs_z_obligacji(t_wkp[i],rent_p[i],kpt,rent_f[i],t_sprz ))
}


```


# II scenariusz:


```{r II}
t_wkp = c(1,2,3,4,5)
rent_p = c(3.1, 3.8, 4, 4.2,4.3)/100
kpt = 2
rent_f = rent_p+0.005
t_sprz = 1
for( i in 1:5){
  print(hajs_z_obligacji(t_wkp[i],rent_p[i],kpt,rent_f[i],t_sprz ))
}


```





#_______________________________________________________________________________
#
#------------------------------Zadanie 3.6--------------------------------------
#
#_______________________________________________________________________________
# Znajdź YTM dla 30-letniej obligacji o wartości nominalnej 1000 PLN 
# i kuponach 40 PLN płaconych na koniec każdego roku. 
# Cena obligacji wynosi 1200 PLN.
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 


```{r zad6}
YTM_finder <- function(YTM,czasy,w_nomin,kupony,cen_obl){
  sum = - cen_obl
  for (i in czasy){
    sum = sum + kupony/(1+YTM)^i
  }
  return (sum+w_nomin/(1+YTM)^max(czasy))
}

res <- uniroot(
  f = function(r) YTM_finder(r, czasy = 1:30, w_nomin=1000, kupony=40, cen_obl=1200),
  interval = c(0.000001, 0.99)
)
res$root


```

odp : 2.979%
#_______________________________________________________________________________
#
#------------------------------Zadanie 3.7--------------------------------------
#
#_______________________________________________________________________________
# Rozpatrujemy obligacje skarbowe serii PS0728. 
# Oblicz YTM tej obligacji kupionej na przetargu, 
# który był rozliczany 25.01.2023.
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

```{r zad7}

# kupno 25.01.2023
# Oprocentowanie 7.5%
# sprzedaż 2028-07-25

w_nomin = 1000

c_wykup = 1070 + 37.81 
czasy = seq(0.5,5.5,1)
res <- uniroot(
  f = function(r) YTM_finder(r, czasy, w_nomin=1000, kupony=75, cen_obl=c_wykup),
  interval = c(0.000001, 0.99)
)
res$root




```
odp : 5.95..%
#_______________________________________________________________________________
#
#------------------------------Zadanie 3.8--------------------------------------
#
#_______________________________________________________________________________
# Rozpatrzmy obligację z dwuletnim terminem wykupu, o wartości nominalnej 
# 1000 PLN, 20% kuponie płatnym co pół roku i YTM równym 15%. 
#
# (a) Jaka jest jej bieżąca wartość (cena)?
# (b) Jaki jest czas trwania obligacji?
# (c) Jaki jest zmodyfikowany czas trwania obligacji?
# (d) Jak i w przybliżeniu o ile zmieni się cena obligacji, gdy YTM 
#     spadnie do 14%?
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
```{r prerequires}
YTM = 0.15
w_nomin = 1000
kupon = 0.2
czasy = seq(1,4,1)
#4 orkesy kapitalizacji co pół roku ze stopą na jeden okres YTM/2


```

# (a)
```{r a}
P = sum(w_nomin*(kupon/2)/(1+YTM/2)^czasy) + 1000/(1+YTM/2)^4
P

```

# (b)      
```{r b}

T = (sum((w_nomin*(kupon/2)/(1+YTM/2)^czasy)*czasy) + 4*1000/(1+YTM/2)^4)/P
T #aleto chyba jest w połówkach więc w latach będzie 
T/2
```
odp : 1.754 roku

# (c)  
```{r c}
zmT = (T)/(1+YTM/2)
#ale to jest w połówkach więc
zmT/2


```
odp 1.63187

# (d)   

```{r d}
YTM = 0.14
P1 = sum(w_nomin*(kupon/2)/(1+YTM/2)^czasy) + 1000/(1+YTM/2)^4
print(P1)
P1-P
```
Podniesie się o ok 17.88318 zł


